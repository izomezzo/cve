package politse.ejb;

import java.io.UnsupportedEncodingException;
import java.security.NoSuchAlgorithmException;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.ejb.NoSuchObjectLocalException;
import javax.ejb.Stateful;
import javax.enterprise.context.RequestScoped;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import politse.entity.Trader;
import politse.entity.User;

@RequestScoped
@Stateful
public class LoginRequest {

	 @PersistenceContext
	 private EntityManager em;
	 private static final Logger logger = Logger.getLogger("politse.ejb.LoginRequest");
	 
	  public void createUser(String userId, String password, String salt, Integer trader) throws NoSuchAlgorithmException, UnsupportedEncodingException
	  {
	    	User user = new User(userId,password,salt,em.find(Trader.class, trader));
	    	em.persist(user);
	  }
	  
	  public User findUser(String username) 
	  {
		  logger.log(Level.INFO, "LoginRequest.findUser trying to find user {0}",  new Object[]{username});
		  
		  User user = null;		  
		  try{
		  	 	user = (User) em.createNamedQuery(
		  			"findUser").setParameter("username", username).getSingleResult();		
		  }catch(Exception e){}
		  
		  return user;
	  }
	  
}
